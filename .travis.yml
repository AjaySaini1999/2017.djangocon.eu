# This file is generated by GitLab CI
language: python
python:
  - "3.5"

services:
  - postgresql

before_script:
  - psql -c 'create database travis_ci_test;' -U postgres

env:
  global:
    - SECRET_KEY: 'IOIO'
    - ALLOWED_HOSTS: '*'
    - CACHE_URL: 'dummycache://'
    - DATABASE_URL: 'psql://postgres:@:5432/djangocon_europe'
    - EMAIL_HOST: 'localhost'

before_install:
  - nvm install node
  - nvm use node
  - gem install bundler
  - npm install -g jshint
  - npm install -g grunt-cli
  - pip install coverage
  - pip install codecov

install:
  - npm install
  - bundle install --deployment
  - pip install -r requirements-test.txt

script:
  - flake8 djangocon_europe conference
  - isort -c -rc -df djangocon_europe conference
  - coverage run --source djangocon_europe,conference manage.py test --settings=djangocon_europe.settings_ci

after_script:
  - codecov
